{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Routes,Route,Navigate,useLocation}from\"react-router-dom\";import LoginForm from\"./components/LoginForm\";import Dashboard from\"./components/Dashboard\";import CompanyDetails from\"./components/CompanyDetails\";import{me,logoutRequest}from\"./authService\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[user,setUser]=useState(null);const[checkingSession,setCheckingSession]=useState(true);const location=useLocation();useEffect(()=>{(async()=>{try{const current=await me();setUser(current);}catch(_unused){setUser(null);}finally{setCheckingSession(false);}})();},[]);const handleLoginSuccess=loggedUser=>{setUser(loggedUser);};const handleLogout=async()=>{try{await logoutRequest();}catch(_unused2){// nawet jeśli backend nie odpowie, to i tak czyścimy stan\n}finally{setUser(null);}};if(checkingSession){return/*#__PURE__*/_jsx(\"div\",{style:{padding:24},children:\"\\u0141adowanie\\u2026\"});}const requireAuth=element=>{if(user)return element;return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true,state:{from:location.pathname}});};return/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",element:user?/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true}):/*#__PURE__*/_jsx(LoginForm,{onLoginSuccess:handleLoginSuccess})}),/*#__PURE__*/_jsx(Route,{path:\"/\",element:requireAuth(/*#__PURE__*/_jsx(Dashboard,{user:user,onLogout:handleLogout}))}),/*#__PURE__*/_jsx(Route,{path:\"/admin/companies/:id\",element:requireAuth(/*#__PURE__*/_jsx(CompanyDetails,{user:user,onLogout:handleLogout}))}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:user?\"/\":\"/login\",replace:true})})]});};export default App;","map":{"version":3,"names":["React","useEffect","useState","Routes","Route","Navigate","useLocation","LoginForm","Dashboard","CompanyDetails","me","logoutRequest","jsx","_jsx","jsxs","_jsxs","App","user","setUser","checkingSession","setCheckingSession","location","current","_unused","handleLoginSuccess","loggedUser","handleLogout","_unused2","style","padding","children","requireAuth","element","to","replace","state","from","pathname","path","onLoginSuccess","onLogout"],"sources":["/var/www/web-szyper/src/App.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Routes, Route, Navigate, useLocation } from \"react-router-dom\";\n\nimport LoginForm from \"./components/LoginForm\";\nimport Dashboard from \"./components/Dashboard\";\nimport CompanyDetails from \"./components/CompanyDetails\";\n\nimport type { User } from \"./types\";\nimport { me, logoutRequest } from \"./authService\";\n\nconst App: React.FC = () => {\n    const [user, setUser] = useState<User | null>(null);\n    const [checkingSession, setCheckingSession] = useState(true);\n    const location = useLocation();\n\n    useEffect(() => {\n        (async () => {\n            try {\n                const current = await me();\n                setUser(current);\n            } catch {\n                setUser(null);\n            } finally {\n                setCheckingSession(false);\n            }\n        })();\n    }, []);\n\n    const handleLoginSuccess = (loggedUser: User) => {\n        setUser(loggedUser);\n    };\n\n    const handleLogout = async () => {\n        try {\n            await logoutRequest();\n        } catch {\n            // nawet jeśli backend nie odpowie, to i tak czyścimy stan\n        } finally {\n            setUser(null);\n        }\n    };\n\n    if (checkingSession) {\n        return <div style={{ padding: 24 }}>Ładowanie…</div>;\n    }\n\n    const requireAuth = (element: React.ReactElement) => {\n        if (user) return element;\n        return <Navigate to=\"/login\" replace state={{ from: location.pathname }} />;\n    };\n\n    return (\n        <Routes>\n            <Route\n                path=\"/login\"\n                element={\n                    user ? (\n                        <Navigate to=\"/\" replace />\n                    ) : (\n                        <LoginForm onLoginSuccess={handleLoginSuccess} />\n                    )\n                }\n            />\n\n            <Route\n                path=\"/\"\n                element={requireAuth(<Dashboard user={user as User} onLogout={handleLogout} />)}\n            />\n\n            <Route\n                path=\"/admin/companies/:id\"\n                element={requireAuth(<CompanyDetails user={user as User} onLogout={handleLogout} />)}\n            />\n\n            <Route path=\"*\" element={<Navigate to={user ? \"/\" : \"/login\"} replace />} />\n        </Routes>\n    );\n};\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}