{"ast":null,"code":"// src/reportService.ts\nimport{apiFetchBlob}from\"./api\";function triggerDownload(blob,filename){const url=window.URL.createObjectURL(blob);const a=document.createElement(\"a\");a.href=url;a.download=filename;document.body.appendChild(a);a.click();a.remove();window.URL.revokeObjectURL(url);}export async function downloadKpirPdf(period){const{blob,filename}=await apiFetchBlob(\"/api/reports/kpir\",{method:\"POST\",body:JSON.stringify(period)});const fallback=period.mode===\"month\"?\"kpir-\".concat(period.year,\"-\").concat(String(period.month).padStart(2,\"0\"),\".pdf\"):period.mode===\"quarter\"?\"kpir-\".concat(period.year,\"-Q\").concat(period.quarter,\".pdf\"):\"kpir-\".concat(period.year,\".pdf\");triggerDownload(blob,filename!==null&&filename!==void 0?filename:fallback);}export async function downloadContractorsXlsx(params){const{blob,filename}=await apiFetchBlob(\"/api/reports/contractors-xlsx\",{method:\"POST\",body:JSON.stringify(params)});triggerDownload(blob,filename!==null&&filename!==void 0?filename:\"raport-kontrahenci-\".concat(params.dateFrom,\"_\").concat(params.dateTo,\".xlsx\"));}","map":{"version":3,"names":["apiFetchBlob","triggerDownload","blob","filename","url","window","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","remove","revokeObjectURL","downloadKpirPdf","period","method","JSON","stringify","fallback","mode","concat","year","String","month","padStart","quarter","downloadContractorsXlsx","params","dateFrom","dateTo"],"sources":["/var/www/web-szyper/src/reportService.ts"],"sourcesContent":["// src/reportService.ts\nimport { apiFetchBlob } from \"./api\";\n\ntype KpirPeriod =\n    | { mode: \"month\"; year: number; month: number } // 1-12\n    | { mode: \"quarter\"; year: number; quarter: number } // 1-4\n    | { mode: \"year\"; year: number };\n\ntype ContractorXlsxParams = {\n    dateFrom: string; // YYYY-MM-DD\n    dateTo: string; // YYYY-MM-DD\n    includeIncome: boolean;\n    includeCost: boolean;\n    contractorId?: number | null;\n};\n\nfunction triggerDownload(blob: Blob, filename: string) {\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n    window.URL.revokeObjectURL(url);\n}\n\nexport async function downloadKpirPdf(period: KpirPeriod) {\n    const { blob, filename } = await apiFetchBlob(\"/api/reports/kpir\", {\n        method: \"POST\",\n        body: JSON.stringify(period),\n    });\n\n    const fallback =\n        period.mode === \"month\"\n            ? `kpir-${period.year}-${String(period.month).padStart(2, \"0\")}.pdf`\n            : period.mode === \"quarter\"\n                ? `kpir-${period.year}-Q${period.quarter}.pdf`\n                : `kpir-${period.year}.pdf`;\n\n    triggerDownload(blob, filename ?? fallback);\n}\n\nexport async function downloadContractorsXlsx(params: ContractorXlsxParams) {\n    const { blob, filename } = await apiFetchBlob(\"/api/reports/contractors-xlsx\", {\n        method: \"POST\",\n        body: JSON.stringify(params),\n    });\n\n    triggerDownload(blob, filename ?? `raport-kontrahenci-${params.dateFrom}_${params.dateTo}.xlsx`);\n}"],"mappings":"AAAA;AACA,OAASA,YAAY,KAAQ,OAAO,CAepC,QAAS,CAAAC,eAAeA,CAACC,IAAU,CAAEC,QAAgB,CAAE,CACnD,KAAM,CAAAC,GAAG,CAAGC,MAAM,CAACC,GAAG,CAACC,eAAe,CAACL,IAAI,CAAC,CAC5C,KAAM,CAAAM,CAAC,CAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC,CACrCF,CAAC,CAACG,IAAI,CAAGP,GAAG,CACZI,CAAC,CAACI,QAAQ,CAAGT,QAAQ,CACrBM,QAAQ,CAACI,IAAI,CAACC,WAAW,CAACN,CAAC,CAAC,CAC5BA,CAAC,CAACO,KAAK,CAAC,CAAC,CACTP,CAAC,CAACQ,MAAM,CAAC,CAAC,CACVX,MAAM,CAACC,GAAG,CAACW,eAAe,CAACb,GAAG,CAAC,CACnC,CAEA,MAAO,eAAe,CAAAc,eAAeA,CAACC,MAAkB,CAAE,CACtD,KAAM,CAAEjB,IAAI,CAAEC,QAAS,CAAC,CAAG,KAAM,CAAAH,YAAY,CAAC,mBAAmB,CAAE,CAC/DoB,MAAM,CAAE,MAAM,CACdP,IAAI,CAAEQ,IAAI,CAACC,SAAS,CAACH,MAAM,CAC/B,CAAC,CAAC,CAEF,KAAM,CAAAI,QAAQ,CACVJ,MAAM,CAACK,IAAI,GAAK,OAAO,SAAAC,MAAA,CACTN,MAAM,CAACO,IAAI,MAAAD,MAAA,CAAIE,MAAM,CAACR,MAAM,CAACS,KAAK,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,SAC5DV,MAAM,CAACK,IAAI,GAAK,SAAS,SAAAC,MAAA,CACbN,MAAM,CAACO,IAAI,OAAAD,MAAA,CAAKN,MAAM,CAACW,OAAO,iBAAAL,MAAA,CAC9BN,MAAM,CAACO,IAAI,QAAM,CAEvCzB,eAAe,CAACC,IAAI,CAAEC,QAAQ,SAARA,QAAQ,UAARA,QAAQ,CAAIoB,QAAQ,CAAC,CAC/C,CAEA,MAAO,eAAe,CAAAQ,uBAAuBA,CAACC,MAA4B,CAAE,CACxE,KAAM,CAAE9B,IAAI,CAAEC,QAAS,CAAC,CAAG,KAAM,CAAAH,YAAY,CAAC,+BAA+B,CAAE,CAC3EoB,MAAM,CAAE,MAAM,CACdP,IAAI,CAAEQ,IAAI,CAACC,SAAS,CAACU,MAAM,CAC/B,CAAC,CAAC,CAEF/B,eAAe,CAACC,IAAI,CAAEC,QAAQ,SAARA,QAAQ,UAARA,QAAQ,uBAAAsB,MAAA,CAA0BO,MAAM,CAACC,QAAQ,MAAAR,MAAA,CAAIO,MAAM,CAACE,MAAM,SAAO,CAAC,CACpG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}