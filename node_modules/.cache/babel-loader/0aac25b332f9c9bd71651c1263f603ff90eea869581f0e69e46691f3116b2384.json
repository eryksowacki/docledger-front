{"ast":null,"code":"// src/categoryService.ts\nimport{apiFetch}from\"./api\";function buildQuery(params){const qs=new URLSearchParams();Object.entries(params).forEach(_ref=>{let[k,v]=_ref;if(v!==undefined&&v!==\"\")qs.set(k,v);});const s=qs.toString();return s?\"?\".concat(s):\"\";}/**\n * Backend może zwracać:\n * - CategoryRow[]\n * - { data: CategoryRow[] }\n * - { data: CategoryRow[], meta, links } (paginacja)\n */function normalizeCategories(resp){if(Array.isArray(resp))return resp;if(resp&&Array.isArray(resp.data))return resp.data;return[];}export async function listCategories(){let query=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const q=buildQuery({type:query.type});const resp=await apiFetch(\"/api/categories\".concat(q),{method:\"GET\"});return normalizeCategories(resp);}export async function createCategory(payload){return apiFetch(\"/api/categories\",{method:\"POST\",body:JSON.stringify(payload)});}export async function updateCategory(id,payload){return apiFetch(\"/api/categories/\".concat(id),{method:\"PATCH\",body:JSON.stringify(payload)});}export async function deleteCategory(id){await apiFetch(\"/api/categories/\".concat(id),{method:\"DELETE\"});}","map":{"version":3,"names":["apiFetch","buildQuery","params","qs","URLSearchParams","Object","entries","forEach","_ref","k","v","undefined","set","s","toString","concat","normalizeCategories","resp","Array","isArray","data","listCategories","query","arguments","length","q","type","method","createCategory","payload","body","JSON","stringify","updateCategory","id","deleteCategory"],"sources":["/var/www/web-szyper/src/categoryService.ts"],"sourcesContent":["// src/categoryService.ts\nimport { apiFetch } from \"./api\";\nimport type { CategoryRow, DocumentType } from \"./types\";\n\nfunction buildQuery(params: Record<string, string | undefined>) {\n    const qs = new URLSearchParams();\n    Object.entries(params).forEach(([k, v]) => {\n        if (v !== undefined && v !== \"\") qs.set(k, v);\n    });\n    const s = qs.toString();\n    return s ? `?${s}` : \"\";\n}\n\n/**\n * Backend może zwracać:\n * - CategoryRow[]\n * - { data: CategoryRow[] }\n * - { data: CategoryRow[], meta, links } (paginacja)\n */\ntype CategoriesApiResponse =\n    | CategoryRow[]\n    | { data: CategoryRow[] }\n    | { data: CategoryRow[]; meta?: any; links?: any };\n\nfunction normalizeCategories(resp: CategoriesApiResponse): CategoryRow[] {\n    if (Array.isArray(resp)) return resp;\n    if (resp && Array.isArray((resp as any).data)) return (resp as any).data;\n    return [];\n}\n\nexport async function listCategories(\n    query: { type?: DocumentType } = {}\n): Promise<CategoryRow[]> {\n    const q = buildQuery({ type: query.type });\n    const resp = await apiFetch<CategoriesApiResponse>(`/api/categories${q}`, {\n        method: \"GET\",\n    });\n    return normalizeCategories(resp);\n}\n\nexport async function createCategory(payload: {\n    name: string;\n    type: \"INCOME\" | \"COST\";\n}): Promise<{ id: number }> {\n    return apiFetch<{ id: number }>(`/api/categories`, {\n        method: \"POST\",\n        body: JSON.stringify(payload),\n    });\n}\n\nexport async function updateCategory(\n    id: number,\n    payload: { name?: string; type?: \"INCOME\" | \"COST\" }\n): Promise<{ id: number }> {\n    return apiFetch<{ id: number }>(`/api/categories/${id}`, {\n        method: \"PATCH\",\n        body: JSON.stringify(payload),\n    });\n}\n\nexport async function deleteCategory(id: number): Promise<void> {\n    await apiFetch<void>(`/api/categories/${id}`, { method: \"DELETE\" });\n}"],"mappings":"AAAA;AACA,OAASA,QAAQ,KAAQ,OAAO,CAGhC,QAAS,CAAAC,UAAUA,CAACC,MAA0C,CAAE,CAC5D,KAAM,CAAAC,EAAE,CAAG,GAAI,CAAAC,eAAe,CAAC,CAAC,CAChCC,MAAM,CAACC,OAAO,CAACJ,MAAM,CAAC,CAACK,OAAO,CAACC,IAAA,EAAY,IAAX,CAACC,CAAC,CAAEC,CAAC,CAAC,CAAAF,IAAA,CAClC,GAAIE,CAAC,GAAKC,SAAS,EAAID,CAAC,GAAK,EAAE,CAAEP,EAAE,CAACS,GAAG,CAACH,CAAC,CAAEC,CAAC,CAAC,CACjD,CAAC,CAAC,CACF,KAAM,CAAAG,CAAC,CAAGV,EAAE,CAACW,QAAQ,CAAC,CAAC,CACvB,MAAO,CAAAD,CAAC,KAAAE,MAAA,CAAOF,CAAC,EAAK,EAAE,CAC3B,CAEA;AACA;AACA;AACA;AACA;AACA,GAMA,QAAS,CAAAG,mBAAmBA,CAACC,IAA2B,CAAiB,CACrE,GAAIC,KAAK,CAACC,OAAO,CAACF,IAAI,CAAC,CAAE,MAAO,CAAAA,IAAI,CACpC,GAAIA,IAAI,EAAIC,KAAK,CAACC,OAAO,CAAEF,IAAI,CAASG,IAAI,CAAC,CAAE,MAAQ,CAAAH,IAAI,CAASG,IAAI,CACxE,MAAO,EAAE,CACb,CAEA,MAAO,eAAe,CAAAC,cAAcA,CAAA,CAEV,IADtB,CAAAC,KAA8B,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAZ,SAAA,CAAAY,SAAA,IAAG,CAAC,CAAC,CAEnC,KAAM,CAAAE,CAAC,CAAGxB,UAAU,CAAC,CAAEyB,IAAI,CAAEJ,KAAK,CAACI,IAAK,CAAC,CAAC,CAC1C,KAAM,CAAAT,IAAI,CAAG,KAAM,CAAAjB,QAAQ,mBAAAe,MAAA,CAA0CU,CAAC,EAAI,CACtEE,MAAM,CAAE,KACZ,CAAC,CAAC,CACF,MAAO,CAAAX,mBAAmB,CAACC,IAAI,CAAC,CACpC,CAEA,MAAO,eAAe,CAAAW,cAAcA,CAACC,OAGpC,CAA2B,CACxB,MAAO,CAAA7B,QAAQ,mBAAoC,CAC/C2B,MAAM,CAAE,MAAM,CACdG,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACH,OAAO,CAChC,CAAC,CAAC,CACN,CAEA,MAAO,eAAe,CAAAI,cAAcA,CAChCC,EAAU,CACVL,OAAoD,CAC7B,CACvB,MAAO,CAAA7B,QAAQ,oBAAAe,MAAA,CAAoCmB,EAAE,EAAI,CACrDP,MAAM,CAAE,OAAO,CACfG,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACH,OAAO,CAChC,CAAC,CAAC,CACN,CAEA,MAAO,eAAe,CAAAM,cAAcA,CAACD,EAAU,CAAiB,CAC5D,KAAM,CAAAlC,QAAQ,oBAAAe,MAAA,CAA0BmB,EAAE,EAAI,CAAEP,MAAM,CAAE,QAAS,CAAC,CAAC,CACvE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}