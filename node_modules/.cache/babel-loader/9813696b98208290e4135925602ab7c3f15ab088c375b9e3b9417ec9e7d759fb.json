{"ast":null,"code":"import{apiFetch}from'./api';const USER_STORAGE_KEY='currentUser';/**\n * Sanctum SPA: musisz najpierw pobrać CSRF cookie,\n * dopiero potem robić POST/PUT/PATCH/DELETE.\n *//*export async function csrfCookie(): Promise<void> {\n    // endpoint jest poza /api\n    await apiFetch('/api/sanctum/csrf-cookie', { method: 'GET' });\n}*/export async function login(email,password){// 1) CSRF cookie\nawait csrfCookie();// 2) login\nconst data=await apiFetch('/api/login',{method:'POST',body:JSON.stringify({email,password})});localStorage.setItem(USER_STORAGE_KEY,JSON.stringify(data));return data;}export async function me(){const data=await apiFetch('/api/me',{method:'GET'});localStorage.setItem(USER_STORAGE_KEY,JSON.stringify(data));return data;}export function getCurrentUser(){const raw=localStorage.getItem(USER_STORAGE_KEY);if(!raw)return null;try{return JSON.parse(raw);}catch(_unused){return null;}}/**\n * Czyści lokalny stan (UI) bez wołania backendu.\n * Zwykle używaj logoutRequest() + logout() razem.\n */export function logout(){localStorage.removeItem(USER_STORAGE_KEY);}/**\n * Wylogowanie na backendzie (unieważnia sesję).\n * Dla pewności robi CSRF cookie (czasem wymagane przy POST).\n */export async function logoutRequest(){try{await csrfCookie();await apiFetch('/api/logout',{method:'POST'});}finally{logout();}}","map":{"version":3,"names":["apiFetch","USER_STORAGE_KEY","login","email","password","csrfCookie","data","method","body","JSON","stringify","localStorage","setItem","me","getCurrentUser","raw","getItem","parse","_unused","logout","removeItem","logoutRequest"],"sources":["/var/www/web-szyper/src/authService.ts"],"sourcesContent":["import { apiFetch } from './api';\nimport type { User } from './types';\n\nconst USER_STORAGE_KEY = 'currentUser';\n\n/**\n * Sanctum SPA: musisz najpierw pobrać CSRF cookie,\n * dopiero potem robić POST/PUT/PATCH/DELETE.\n */\n/*export async function csrfCookie(): Promise<void> {\n    // endpoint jest poza /api\n    await apiFetch('/api/sanctum/csrf-cookie', { method: 'GET' });\n}*/\n\nexport async function login(email: string, password: string): Promise<User> {\n    // 1) CSRF cookie\n    await csrfCookie();\n\n    // 2) login\n    const data = await apiFetch<User>('/api/login', {\n        method: 'POST',\n        body: JSON.stringify({ email, password }),\n    });\n\n    localStorage.setItem(USER_STORAGE_KEY, JSON.stringify(data));\n    return data;\n}\n\nexport async function me(): Promise<User> {\n    const data = await apiFetch<User>('/api/me', { method: 'GET' });\n    localStorage.setItem(USER_STORAGE_KEY, JSON.stringify(data));\n    return data;\n}\n\nexport function getCurrentUser(): User | null {\n    const raw = localStorage.getItem(USER_STORAGE_KEY);\n    if (!raw) return null;\n\n    try {\n        return JSON.parse(raw) as User;\n    } catch {\n        return null;\n    }\n}\n\n/**\n * Czyści lokalny stan (UI) bez wołania backendu.\n * Zwykle używaj logoutRequest() + logout() razem.\n */\nexport function logout(): void {\n    localStorage.removeItem(USER_STORAGE_KEY);\n}\n\n/**\n * Wylogowanie na backendzie (unieważnia sesję).\n * Dla pewności robi CSRF cookie (czasem wymagane przy POST).\n */\nexport async function logoutRequest(): Promise<void> {\n    try {\n        await csrfCookie();\n        await apiFetch('/api/logout', { method: 'POST' });\n    } finally {\n        logout();\n    }\n}\n"],"mappings":"AAAA,OAASA,QAAQ,KAAQ,OAAO,CAGhC,KAAM,CAAAC,gBAAgB,CAAG,aAAa,CAEtC;AACA;AACA;AACA,GACA;AACA;AACA;AACA,GAEA,MAAO,eAAe,CAAAC,KAAKA,CAACC,KAAa,CAAEC,QAAgB,CAAiB,CACxE;AACA,KAAM,CAAAC,UAAU,CAAC,CAAC,CAElB;AACA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAN,QAAQ,CAAO,YAAY,CAAE,CAC5CO,MAAM,CAAE,MAAM,CACdC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEP,KAAK,CAAEC,QAAS,CAAC,CAC5C,CAAC,CAAC,CAEFO,YAAY,CAACC,OAAO,CAACX,gBAAgB,CAAEQ,IAAI,CAACC,SAAS,CAACJ,IAAI,CAAC,CAAC,CAC5D,MAAO,CAAAA,IAAI,CACf,CAEA,MAAO,eAAe,CAAAO,EAAEA,CAAA,CAAkB,CACtC,KAAM,CAAAP,IAAI,CAAG,KAAM,CAAAN,QAAQ,CAAO,SAAS,CAAE,CAAEO,MAAM,CAAE,KAAM,CAAC,CAAC,CAC/DI,YAAY,CAACC,OAAO,CAACX,gBAAgB,CAAEQ,IAAI,CAACC,SAAS,CAACJ,IAAI,CAAC,CAAC,CAC5D,MAAO,CAAAA,IAAI,CACf,CAEA,MAAO,SAAS,CAAAQ,cAAcA,CAAA,CAAgB,CAC1C,KAAM,CAAAC,GAAG,CAAGJ,YAAY,CAACK,OAAO,CAACf,gBAAgB,CAAC,CAClD,GAAI,CAACc,GAAG,CAAE,MAAO,KAAI,CAErB,GAAI,CACA,MAAO,CAAAN,IAAI,CAACQ,KAAK,CAACF,GAAG,CAAC,CAC1B,CAAE,MAAAG,OAAA,CAAM,CACJ,MAAO,KAAI,CACf,CACJ,CAEA;AACA;AACA;AACA,GACA,MAAO,SAAS,CAAAC,MAAMA,CAAA,CAAS,CAC3BR,YAAY,CAACS,UAAU,CAACnB,gBAAgB,CAAC,CAC7C,CAEA;AACA;AACA;AACA,GACA,MAAO,eAAe,CAAAoB,aAAaA,CAAA,CAAkB,CACjD,GAAI,CACA,KAAM,CAAAhB,UAAU,CAAC,CAAC,CAClB,KAAM,CAAAL,QAAQ,CAAC,aAAa,CAAE,CAAEO,MAAM,CAAE,MAAO,CAAC,CAAC,CACrD,CAAC,OAAS,CACNY,MAAM,CAAC,CAAC,CACZ,CACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}