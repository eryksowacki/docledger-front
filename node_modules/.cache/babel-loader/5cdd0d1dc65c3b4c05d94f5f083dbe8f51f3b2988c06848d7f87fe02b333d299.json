{"ast":null,"code":"import React,{useState}from\"react\";import\"./_modal.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function validatePassword(pwd){if(pwd.length<8)return\"Hasło musi mieć minimum 8 znaków.\";if(!/[a-z]/.test(pwd))return\"Hasło musi zawierać minimum jedną małą literę.\";if(!/[A-Z]/.test(pwd))return\"Hasło musi zawierać minimum jedną wielką literę.\";if(!/\\d/.test(pwd))return\"Hasło musi zawierać minimum jedną cyfrę.\";if(!/[^A-Za-z0-9]/.test(pwd))return\"Hasło musi zawierać minimum jeden znak specjalny.\";return null;}export const UserModal=_ref=>{let{companyId,onClose,onSubmit}=_ref;const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[role,setRole]=useState(\"ROLE_EMPLOYEE\");const[firstName,setFirstName]=useState(\"\");const[lastName,setLastName]=useState(\"\");const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const submit=async e=>{e.preventDefault();setLoading(true);setError(null);const pwd=password.trim();const pwdErr=validatePassword(pwd);if(pwdErr){setLoading(false);setError(pwdErr);return;}try{await onSubmit({email:email.trim(),password:pwd,role,companyId,firstName:firstName.trim()?firstName.trim():null,lastName:lastName.trim()?lastName.trim():null});onClose();}catch(err){var _err$message;console.error(err);setError((_err$message=err===null||err===void 0?void 0:err.message)!==null&&_err$message!==void 0?_err$message:\"Nie udało się utworzyć użytkownika (sprawdź email/hasło lub duplikat).\");}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"m-overlay\",onMouseDown:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"m-card\",onMouseDown:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"m-head\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Dodaj u\\u017Cytkownika\"}),/*#__PURE__*/_jsx(\"button\",{className:\"m-x\",onClick:onClose,type:\"button\",children:\"\\xD7\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"m-error\",children:error}),/*#__PURE__*/_jsxs(\"form\",{className:\"m-form\",onSubmit:submit,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Email\",/*#__PURE__*/_jsx(\"input\",{value:email,onChange:e=>setEmail(e.target.value),type:\"email\",required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Has\\u0142o\",/*#__PURE__*/_jsx(\"input\",{value:password,onChange:e=>setPassword(e.target.value),type:\"password\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"m-row\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Imi\\u0119\",/*#__PURE__*/_jsx(\"input\",{value:firstName,onChange:e=>setFirstName(e.target.value)})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Nazwisko\",/*#__PURE__*/_jsx(\"input\",{value:lastName,onChange:e=>setLastName(e.target.value)})]})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Rola\",/*#__PURE__*/_jsxs(\"select\",{value:role,onChange:e=>setRole(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"ROLE_EMPLOYEE\",children:\"Pracownik\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ROLE_MANAGER\",children:\"Kierownik\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ROLE_SYSTEM_ADMIN\",children:\"Admin systemu\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"m-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"m-btn m-btn--ghost\",onClick:onClose,disabled:loading,children:\"Anuluj\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"m-btn m-btn--primary\",disabled:loading,children:loading?\"Zapisywanie...\":\"Utwórz\"})]})]})]})});};","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","validatePassword","pwd","length","test","UserModal","_ref","companyId","onClose","onSubmit","email","setEmail","password","setPassword","role","setRole","firstName","setFirstName","lastName","setLastName","loading","setLoading","error","setError","submit","e","preventDefault","trim","pwdErr","err","_err$message","console","message","className","onMouseDown","children","stopPropagation","onClick","type","value","onChange","target","required","disabled"],"sources":["/var/www/web-szyper/src/components/UserModal.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport type { AdminUserCreateRequest } from \"../types\";\nimport \"./_modal.css\";\n\ntype Props = {\n    companyId: number;\n    onClose: () => void;\n    onSubmit: (payload: AdminUserCreateRequest) => Promise<void>;\n};\n\nfunction validatePassword(pwd: string): string | null {\n    if (pwd.length < 8) return \"Hasło musi mieć minimum 8 znaków.\";\n    if (!/[a-z]/.test(pwd)) return \"Hasło musi zawierać minimum jedną małą literę.\";\n    if (!/[A-Z]/.test(pwd)) return \"Hasło musi zawierać minimum jedną wielką literę.\";\n    if (!/\\d/.test(pwd)) return \"Hasło musi zawierać minimum jedną cyfrę.\";\n    if (!/[^A-Za-z0-9]/.test(pwd)) return \"Hasło musi zawierać minimum jeden znak specjalny.\";\n    return null;\n}\n\nexport const UserModal: React.FC<Props> = ({ companyId, onClose, onSubmit }) => {\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [role, setRole] = useState(\"ROLE_EMPLOYEE\");\n    const [firstName, setFirstName] = useState<string>(\"\");\n    const [lastName, setLastName] = useState<string>(\"\");\n\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const submit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        setError(null);\n\n        const pwd = password.trim();\n        const pwdErr = validatePassword(pwd);\n        if (pwdErr) {\n            setLoading(false);\n            setError(pwdErr);\n            return;\n        }\n\n        try {\n            await onSubmit({\n                email: email.trim(),\n                password: pwd,\n                role,\n                companyId,\n                firstName: firstName.trim() ? firstName.trim() : null,\n                lastName: lastName.trim() ? lastName.trim() : null,\n            });\n            onClose();\n        } catch (err: any) {\n            console.error(err);\n            setError(err?.message ?? \"Nie udało się utworzyć użytkownika (sprawdź email/hasło lub duplikat).\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"m-overlay\" onMouseDown={onClose}>\n            <div className=\"m-card\" onMouseDown={(e) => e.stopPropagation()}>\n                <div className=\"m-head\">\n                    <h2>Dodaj użytkownika</h2>\n                    <button className=\"m-x\" onClick={onClose} type=\"button\">×</button>\n                </div>\n\n                {error && <div className=\"m-error\">{error}</div>}\n\n                <form className=\"m-form\" onSubmit={submit}>\n                    <label>\n                        Email\n                        <input value={email} onChange={(e) => setEmail(e.target.value)} type=\"email\" required />\n                    </label>\n\n                    <label>\n                        Hasło\n                        <input value={password} onChange={(e) => setPassword(e.target.value)} type=\"password\" required />\n                    </label>\n\n                    <div className=\"m-row\">\n                        <label>\n                            Imię\n                            <input value={firstName} onChange={(e) => setFirstName(e.target.value)} />\n                        </label>\n\n                        <label>\n                            Nazwisko\n                            <input value={lastName} onChange={(e) => setLastName(e.target.value)} />\n                        </label>\n                    </div>\n\n                    <label>\n                        Rola\n                        <select value={role} onChange={(e) => setRole(e.target.value)}>\n                            <option value=\"ROLE_EMPLOYEE\">Pracownik</option>\n                            <option value=\"ROLE_MANAGER\">Kierownik</option>\n                            <option value=\"ROLE_SYSTEM_ADMIN\">Admin systemu</option>\n                        </select>\n                    </label>\n\n                    <div className=\"m-actions\">\n                        <button type=\"button\" className=\"m-btn m-btn--ghost\" onClick={onClose} disabled={loading}>\n                            Anuluj\n                        </button>\n                        <button type=\"submit\" className=\"m-btn m-btn--primary\" disabled={loading}>\n                            {loading ? \"Zapisywanie...\" : \"Utwórz\"}\n                        </button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}